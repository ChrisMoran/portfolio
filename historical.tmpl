<!DOCTYPE html>
<html lang="en">
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="jquery.flot.js"> </script>
<script type="text/javascript" src="jquery.flot.time.js"> </script>
<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen"/>
<script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
</head>
<body>
<h1>Historical</h1>
<h2><TMPL_VAR NAME=HOME></h2>
<div id='plot-placeholder'style="width:600px;height:300px">

</div>
<input class="interval-rb" type="radio" name="group1" value="week" /> Week
<input class="interval-rb" type="radio" name="group1" value="month"/> Month
<input class="interval-rb" type="radio" name="group1" value="quarter" checked='true'/> Quarter
<input class="interval-rb" type="radio" name="group1" value="year"/> Yr
<input class="interval-rb" type="radio" name="group1" value="5year"/> 5Yr

<hr>
<h3>Explore other stocks</h3>
<p>Some options are AA, MSFT, XOM, etc</p>
<form action="" method="get">

  Go to: <input type="text" name="symbol"><br>
  <input type="submit" value="Submit">
</form>
<script>
//Helper to get an URL parameter
function getURLParameter(name) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
    );
}
tempdata=0
function startPlotting(){
var interval = $('.interval-rb:checked').val();
console.log(interval);
var symbol = getURLParameter("symbol");
var dataToSend={"symbol":symbol, "interval":interval};
  $.getJSON('historical-json.pl', dataToSend, function(data){
		tempdata=data;
		console.log(data)
		plot_data=[];
		for (i=0;i<data.plot_data.length;i++){
			plot_data.push([data.plot_data[i][0]*1000,data.plot_data[i][1]]);
		}
		console.log(plot_data);
		$.plot($("#plot-placeholder"), [plot_data],{xaxis: {mode: "time"}});
	});

}

jQuery(document).ready(function($) {
	//bind a handler for the interval radio button's
	$(".interval-rb").change(function(){
		startPlotting();
	});
	startPlotting();
});
</script>
</body>
</html>